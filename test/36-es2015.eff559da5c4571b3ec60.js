(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{gZbI:function(t,e,i){"use strict";i.r(e),i.d(e,"SpecialExamsModule",(function(){return Pt}));var s=i("ofXK"),c=i("tyNb"),n=i("n+G7"),o=i("SP9e"),a=i("fXoL"),r=i("4KEQ"),l=i("QeEr"),h=i("jhN1");let d=(()=>{class t{constructor(t){this.coreService=t}getOMRCoordinates(t){this.coreService.getRequest(o.a.API_URL+"omr/"+t+"/omr-coords").subscribe(t=>{this.X1=t.X1,this.X2=t.X2,this.X3=t.X3,this.Y1=t.Y1,this.Y2=t.Y2,this.Y3=t.Y3})}setContextInFunctions(t){this.ctx=t}checkIsRoundFilled(t,e){let i=[];return i.push(this.isCoordinatesBlack(t,e)),i.push(this.isCoordinatesBlack(t-8,e)),i.push(this.isCoordinatesBlack(t-7,e)),i.push(this.isCoordinatesBlack(t-6,e)),i.push(this.isCoordinatesBlack(t-5,e)),i.push(this.isCoordinatesBlack(t-4,e)),i.push(this.isCoordinatesBlack(t-3,e)),i.push(this.isCoordinatesBlack(t-2,e)),i.push(this.isCoordinatesBlack(t-1,e)),i.push(this.isCoordinatesBlack(t+1,e)),i.push(this.isCoordinatesBlack(t+2,e)),i.push(this.isCoordinatesBlack(t+3,e)),i.push(this.isCoordinatesBlack(t+4,e)),i.push(this.isCoordinatesBlack(t+5,e)),i.push(this.isCoordinatesBlack(t+6,e)),i.push(this.isCoordinatesBlack(t+7,e)),i.push(this.isCoordinatesBlack(t+8,e)),i.push(this.isCoordinatesBlack(t,e-8)),i.push(this.isCoordinatesBlack(t,e-7)),i.push(this.isCoordinatesBlack(t,e-6)),i.push(this.isCoordinatesBlack(t,e-5)),i.push(this.isCoordinatesBlack(t,e-4)),i.push(this.isCoordinatesBlack(t,e-3)),i.push(this.isCoordinatesBlack(t,e-2)),i.push(this.isCoordinatesBlack(t,e-1)),i.push(this.isCoordinatesBlack(t,e+1)),i.push(this.isCoordinatesBlack(t,e+2)),i.push(this.isCoordinatesBlack(t,e+3)),i.push(this.isCoordinatesBlack(t,e+4)),i.push(this.isCoordinatesBlack(t,e+5)),i.push(this.isCoordinatesBlack(t,e+6)),i.push(this.isCoordinatesBlack(t,e+7)),i.push(this.isCoordinatesBlack(t,e+8)),i.push(this.isCoordinatesBlack(t-7,e+1)),i.push(this.isCoordinatesBlack(t-6,e+2)),i.push(this.isCoordinatesBlack(t-6,e+1)),i.push(this.isCoordinatesBlack(t-5,e+3)),i.push(this.isCoordinatesBlack(t-5,e+2)),i.push(this.isCoordinatesBlack(t-5,e+1)),i.push(this.isCoordinatesBlack(t-7,e-1)),i.push(this.isCoordinatesBlack(t-6,e-2)),i.push(this.isCoordinatesBlack(t-6,e-1)),i.push(this.isCoordinatesBlack(t-5,e-3)),i.push(this.isCoordinatesBlack(t-5,e-2)),i.push(this.isCoordinatesBlack(t-5,e-1)),i.push(this.isCoordinatesBlack(t-1,e-7)),i.push(this.isCoordinatesBlack(t-2,e-6)),i.push(this.isCoordinatesBlack(t-1,e-6)),i.push(this.isCoordinatesBlack(t-3,e-5)),i.push(this.isCoordinatesBlack(t-2,e-5)),i.push(this.isCoordinatesBlack(t-1,e-5)),i.push(this.isCoordinatesBlack(t+1,e-7)),i.push(this.isCoordinatesBlack(t+2,e-6)),i.push(this.isCoordinatesBlack(t+1,e-6)),i.push(this.isCoordinatesBlack(t+3,e-5)),i.push(this.isCoordinatesBlack(t+2,e-5)),i.push(this.isCoordinatesBlack(t+1,e-5)),i.push(this.isCoordinatesBlack(t-1,e-1)),i.push(this.isCoordinatesBlack(t-2,e-2)),i.push(this.isCoordinatesBlack(t-3,e-3)),i.push(this.isCoordinatesBlack(t-4,e-4)),i.push(this.isCoordinatesBlack(t-4,e+4)),i.push(this.isCoordinatesBlack(t-3,e+3)),i.push(this.isCoordinatesBlack(t-2,e+2)),i.push(this.isCoordinatesBlack(t-1,e+1)),i.push(this.isCoordinatesBlack(t+1,e-1)),i.push(this.isCoordinatesBlack(t+2,e-2)),i.push(this.isCoordinatesBlack(t+3,e-3)),i.push(this.isCoordinatesBlack(t+4,e-4)),i.push(this.isCoordinatesBlack(t+1,e+1)),i.push(this.isCoordinatesBlack(t+2,e+2)),i.push(this.isCoordinatesBlack(t+3,e+3)),i.push(this.isCoordinatesBlack(t+4,e+4)),i.filter(t=>1==t).length>=50}isCoordinatesBlack(t,e){let i=this.ctx.getImageData(t,e,1,1).data,s=i[0],c=i[1],n=i[2];return Math.round(Math.sqrt(s*s*.299+c*c*.587+n*n*.114))<150}showRGBAByXY(t,e){let i=this.ctx.getImageData(t,e,1,1).data;console.log(`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${i[3]/255}) `+t+" "+e)}setCorners(){let t=this.getNewX1Y1(),e=this.getNewX2Y2(),i=this.getNewX3Y3();this.XN1=t.XN1,this.YN1=t.YN1,this.XN2=e.XN2,this.YN2=e.YN2,this.XN3=i.XN3,this.YN3=i.YN3}getNewX1Y1(){for(let t=0;t<200;t++)for(let e=0;e<100;e++)if(this.isCoordinatesBlack(e,t)&&!this.isCoordinatesBlack(e,t-2)&&!this.isCoordinatesBlack(e-2,t+2)&&!this.isCoordinatesBlack(e-2,t)&&(this.isCoordinatesBlack(e+10,t)||this.isCoordinatesBlack(e,t+10))&&this.isCoordinatesBlack(e+2,t+2))return{XN1:e,YN1:t}}getNewX2Y2(){for(let t=0;t<200;t++)for(let e=1699;e>1600;e--)if(this.isCoordinatesBlack(e,t)&&!this.isCoordinatesBlack(e,t-2)&&!this.isCoordinatesBlack(e+2,t+2)&&!this.isCoordinatesBlack(e+2,t)&&(this.isCoordinatesBlack(e-10,t)||this.isCoordinatesBlack(e,t+10))&&this.isCoordinatesBlack(e-2,t+2))return{XN2:e,YN2:t}}getNewX3Y3(){for(let t=2199;t>2100;t--)for(let e=0;e<100;e++)if(this.isCoordinatesBlack(e,t)&&!this.isCoordinatesBlack(e,t+2)&&!this.isCoordinatesBlack(e-2,t-2)&&!this.isCoordinatesBlack(e-2,t)&&(this.isCoordinatesBlack(e+10,t)||this.isCoordinatesBlack(e,t-10))&&this.isCoordinatesBlack(e+2,t-2))return{XN3:e,YN3:t}}findNewXCoordinates(t,e){let i=Math.sqrt(Math.pow(this.X2-this.X1,2)+Math.pow(this.Y2-this.Y1,2)),s=Math.sqrt(Math.pow(this.X3-this.X1,2)+Math.pow(this.Y3-this.Y1,2)),c=Math.sqrt(Math.pow(this.XN2-this.XN1,2)+Math.pow(this.YN2-this.YN1,2)),n=Math.sqrt(Math.pow(this.XN3-this.XN1,2)+Math.pow(this.YN3-this.YN1,2));return Math.round(((n*((e*(this.X2-this.X1)+t*(this.Y1-this.Y2)+this.X1*this.Y2-this.X2*this.Y1)/i)*c/s+this.XN2*this.YN1-this.XN1*this.YN2)*(this.XN3-this.XN1)-(n*((e*(this.X3-this.X1)+t*(this.Y1-this.Y3)+this.X1*this.Y3-this.X3*this.Y1)/s)*c/i+this.XN3*this.YN1-this.XN1*this.YN3)*(this.XN2-this.XN1))/((this.YN1-this.YN2)*(this.XN3-this.XN1)-(this.YN1-this.YN3)*(this.XN2-this.XN1)))}findNewYCoordinates(t,e){let i=Math.sqrt(Math.pow(this.X2-this.X1,2)+Math.pow(this.Y2-this.Y1,2)),s=Math.sqrt(Math.pow(this.X3-this.X1,2)+Math.pow(this.Y3-this.Y1,2)),c=Math.sqrt(Math.pow(this.XN2-this.XN1,2)+Math.pow(this.YN2-this.YN1,2)),n=Math.sqrt(Math.pow(this.XN3-this.XN1,2)+Math.pow(this.YN3-this.YN1,2));return Math.round(((n*((e*(this.X2-this.X1)+t*(this.Y1-this.Y2)+this.X1*this.Y2-this.X2*this.Y1)/i)*c/s+this.XN2*this.YN1-this.XN1*this.YN2)*(this.YN1-this.YN3)-(n*((e*(this.X3-this.X1)+t*(this.Y1-this.Y3)+this.X1*this.Y3-this.X3*this.Y1)/s)*c/i+this.XN3*this.YN1-this.XN1*this.YN3)*(this.YN1-this.YN2))/((this.XN2-this.XN1)*(this.YN1-this.YN3)-(this.XN3-this.XN1)*(this.YN1-this.YN2)))}}return t.\u0275fac=function(e){return new(e||t)(a.nc(r.a))},t.\u0275prov=a.Zb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),u=(()=>{class t{constructor(t){this.functionsService=t}setOMR(t){this.omr=t}getXCoords(t,e){return this.functionsService.findNewXCoordinates(t[e].x,t[e].y)}getYCoords(t,e){return this.functionsService.findNewYCoordinates(t[e].x,t[e].y)}getQuestionTypes(){return JSON.parse(this.omr.questionsTypes)}getCalculatedSet(){let t=JSON.parse(this.omr.coordinates).set,e={},i="";return Object.keys(t).forEach(i=>{null!=t[i].x&&null!=t[i].y&&(e[i]=this.functionsService.checkIsRoundFilled(this.getXCoords(t,i),this.getYCoords(t,i)))}),Object.keys(e).forEach(t=>{e[t]&&(i=t[0])}),i}getCalculatedClass(){let t=JSON.parse(this.omr.coordinates).class,e={};for(let c=1;c<=2;c++)for(let i=0;i<=9;i++)e[i+"_"+c]=t[i+"_"+c];let i={};Object.keys(e).forEach(t=>{null!=e[t].x&&null!=e[t].y&&(i[t]=this.functionsService.checkIsRoundFilled(this.getXCoords(e,t),this.getYCoords(e,t)))});let s="";return Object.keys(i).forEach(t=>{i[t]&&(s+=t[0])}),s}getCalculatedRollNo(){let t=JSON.parse(this.omr.coordinates).rollNo,e=this.omr.rollNoCount,i=JSON.parse(this.omr.rollNoAlphabetsIndex).length,s=e-i,c={},n="";for(let a=1;a<=i;a++)for(let e=65;e<=90;e++){let i=String.fromCharCode(e)+a;c[i]=t[i]}for(let a=1;a<=s;a++)for(let e=0;e<=9;e++){let i=e+"_"+a;c[i]=t[i]}let o={};for(let a in c)c[a].x&&c[a].y&&(o[a]=this.functionsService.checkIsRoundFilled(this.getXCoords(c,a),this.getYCoords(c,a)));return Object.keys(o).forEach(t=>{o[t]&&(n+=t[0])}),n}getCalculatedName(){let t=JSON.parse(this.omr.coordinates).name,e={},i=this.omr.nameCharactersCount,s="";for(let n=1;n<=i;n++)for(let i=65;i<=90;i++){let s=String.fromCharCode(i)+n;e[s]=t[s]}let c={};for(let n in e)e[n].x&&e[n].y&&(c[n]=this.functionsService.checkIsRoundFilled(this.getXCoords(e,n),this.getYCoords(e,n)));return Object.keys(c).forEach(t=>{c[t]&&(s+=t[0])}),s}getCalculatedMobile(){let t=JSON.parse(this.omr.coordinates).mobile,e={},i={},s="";for(let c=1;c<=10;c++)for(let i=0;i<=9;i++){let s=i+"_"+c;e[s]=t[s]}for(let c in e)e[c].x&&e[c].y&&(i[c]=this.functionsService.checkIsRoundFilled(this.getXCoords(e,c),this.getYCoords(e,c)));return Object.keys(i).forEach(t=>{i[t]&&(s+=t[0])}),s}getCalculatedResponse(){let t=JSON.parse(this.omr.coordinates).response,e={};Object.keys(t).forEach((i,s)=>{if(!t[i].x||!t[i].y)return e[i]=!1;e[i]=this.functionsService.checkIsRoundFilled(this.getXCoords(t,i),this.getYCoords(t,i))});let i=Object.fromEntries(Object.entries(e).filter(t=>isNaN(t[0][0]))),s=Object.fromEntries(Object.entries(e).filter(t=>!isNaN(t[0][0]))),c=Array.from(new Set(Object.keys(s).map(t=>t.split("-")[0]))),n={};c.forEach(t=>{for(let e=1;e<=2;e++)for(let i=0;i<=9;i++)n[t+"-"+i+"-"+e]=s[t+"-"+i+"-"+e]}),s=n;let o=[],a=[];Object.keys(i).forEach((t,e)=>{i[t]&&a.push(t[0]),e%4==3&&(o.push({option:a}),a=[])});let r="";Object.keys(s).forEach((t,e)=>{s[t]&&(r+=t.split("-")[1]),(e+1)%20==0&&e+1!=0&&(o.push({option:[r]}),r="")}),console.log(JSON.stringify(o,null,2));let l=o.findIndex(t=>!isNaN(t.option[0]));-1==l&&(l=o.length);let h=o.slice(0,l),d=o.slice(l),u=0;return this.integerQuestionsIndex.forEach((t,e)=>{h.splice(t,0,...d.slice(u,u+1)),u++}),o}}return t.\u0275fac=function(e){return new(e||t)(a.nc(d))},t.\u0275prov=a.Zb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=i("kmnG"),m=i("d3UM"),g=i("3Pt+"),f=i("qFsG"),b=i("bTqV"),C=i("5+WD"),M=i("V/o5"),j=i("FKr1"),x=i("QibW"),v=i("bSwM");const I=["form"];function B(t,e){if(1&t&&a.ec(0,"mat-option",26),2&t){const t=e.$implicit;a.Bc("value",t.classId)("innerText",t.className)}}function k(t,e){if(1&t&&a.ec(0,"mat-option",26),2&t){const t=e.$implicit;a.Bc("value",t.setId)("innerText",t.setName)}}function P(t,e){if(1&t){const t=a.kc();a.jc(0,"button",28),a.rc("click",(function(){return a.Mc(t),a.vc(2).scanSheet()})),a.Wc(1," Scan"),a.ic()}}function S(t,e){if(1&t){const t=a.kc();a.jc(0,"button",28),a.rc("click",(function(){return a.Mc(t),a.vc(2).showOMRImage()})),a.Wc(1,"Show OMR"),a.ic()}}function N(t,e){if(1&t&&(a.hc(0),a.Vc(1,P,2,0,"button",27),a.Vc(2,S,2,0,"button",27),a.gc()),2&t){const t=a.vc();a.Pb(1),a.Bc("ngIf",t.isOMRDetailsFetched),a.Pb(1),a.Bc("ngIf",t.isOMRDetailsFetched)}}function O(t,e){if(1&t&&a.ec(0,"mat-option",26),2&t){const t=e.$implicit;a.Bc("value",t.className)("innerText",t.className)}}function w(t,e){if(1&t&&a.ec(0,"mat-option",26),2&t){const t=e.$implicit;a.Bc("value",t.setName)("innerText",t.setName)}}function y(t,e){if(1&t&&a.ec(0,"mat-option",31),2&t){const t=e.$implicit;a.Bc("innerText",t.stream)("value",t.stream)}}function _(t,e){if(1&t){const t=a.kc();a.jc(0,"div",10),a.jc(1,"mat-form-field"),a.jc(2,"mat-label"),a.Wc(3,"Stream"),a.ic(),a.jc(4,"mat-select",29),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().psatData.stream=e})),a.Vc(5,y,1,2,"mat-option",30),a.ic(),a.ic(),a.ic()}if(2&t){const t=a.vc();a.Pb(4),a.Bc("ngModel",t.psatData.stream)("required",t.psatData.streams.length>0),a.Pb(1),a.Bc("ngForOf",t.psatData.streams)}}function R(t,e){if(1&t){const t=a.kc();a.jc(0,"span",35),a.rc("click",(function(){a.Mc(t);const e=a.vc().$implicit;return a.vc().resetOption(e)})),a.ic()}if(2&t){const t=a.vc().index;a.Bc("innerText",t+1)}}function D(t,e){if(1&t){const t=a.kc();a.jc(0,"mat-radio-group",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.single=e})),a.ec(1,"mat-radio-button",37),a.ec(2,"mat-radio-button",37),a.ec(3,"mat-radio-button",37),a.ec(4,"mat-radio-button",37),a.ic()}if(2&t){const t=a.vc(),e=t.$implicit;a.Bc("name","ans_"+t.index)("ngModel",e.single),a.Pb(1),a.Bc("value","A"),a.Pb(1),a.Bc("value","B"),a.Pb(1),a.Bc("value","C"),a.Pb(1),a.Bc("value","D")}}function X(t,e){if(1&t){const t=a.kc();a.hc(0),a.jc(1,"mat-checkbox",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_a=e})),a.ic(),a.jc(2,"mat-checkbox",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_b=e})),a.ic(),a.jc(3,"mat-checkbox",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_c=e})),a.ic(),a.jc(4,"mat-checkbox",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_d=e})),a.ic(),a.gc()}if(2&t){const t=a.vc(),e=t.index,i=t.$implicit;a.Pb(1),a.Bc("name","mul-a"+e)("ngModel",i.multiple.option_a),a.Pb(1),a.Bc("name","mul-b"+e)("ngModel",i.multiple.option_b),a.Pb(1),a.Bc("name","mul-c"+e)("ngModel",i.multiple.option_c),a.Pb(1),a.Bc("name","mul-d"+e)("ngModel",i.multiple.option_d)}}function Y(t,e){if(1&t){const t=a.kc();a.jc(0,"input",36),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.single=e})),a.ic()}if(2&t){const t=a.vc(),e=t.$implicit;a.Bc("name","ans_"+t.index)("ngModel",e.single)}}const T=function(t){return{integer:t}},W=function(){return["S","M","I"]};function q(t,e){if(1&t&&(a.jc(0,"div",32),a.Vc(1,R,1,1,"span",33),a.Vc(2,D,5,6,"mat-radio-group",34),a.Vc(3,X,5,8,"ng-container",5),a.Vc(4,Y,1,2,"input",34),a.ic()),2&t){const t=e.index,i=a.vc();a.Bc("ngClass",a.Dc(5,T,"I"==i.questionType(t))),a.Pb(1),a.Bc("ngIf",a.Cc(7,W).includes(i.questionType(t))),a.Pb(1),a.Bc("ngIf","S"==i.questionType(t)),a.Pb(1),a.Bc("ngIf","M"==i.questionType(t)),a.Pb(1),a.Bc("ngIf","I"==i.questionType(t))}}const F=function(t){return{display:t}};let A,E,V=(()=>{class t{constructor(t,e,i,s,c){this.coreService=t,this.dialog=e,this.sanitizer=i,this.calculateService=s,this.functionsService=c,this.loading1=!0,this.loading2=!0,this.isOMRRead=!1,this.isOMRDetailsFetched=!1,this.showOMR=!1,this.image=new Image,this.psatData={name:null,rollNo:null,mobile:null,class:null,set:null,stream:null,classes:[],sets:[],streams:[],responseSheet:[]},this.questionTypes=[],this.classes=[],this.sets=[],this.integerQuestionsIndex=[]}ngOnInit(){this.omrImage=document.getElementById("omr-image"),E=document.getElementById("canvas"),A=E.getContext("2d"),this.functionsService.setContextInFunctions(A),this.getExamDetails(),this.getClassSetOMR(this.examId)}getExamDetails(){this.coreService.getRequest(o.a.API_URL+"special-exams/"+this.examId+"/details").subscribe(t=>{this.examName=t.examName,this.loading1=!1})}getAnswerKey(){this.coreService.getRequest(o.a.API_URL+"special-exams/set/"+this.setId+"/answer-key").subscribe(t=>{let e=JSON.parse(t.answerKey);this.questionTypes.length=0,e.forEach(t=>{this.questionTypes.push({type:t.questionType})}),this.questionTypes.forEach((t,e)=>{"I"==t.type&&this.integerQuestionsIndex.push(e)}),this.loading2=!1})}setOMR(){this.loading1=!0,this.loading2=!0,this.getAnswerKey();let t=this.sets.find(t=>t.setId==this.setId).omr;if(void 0===t)return this.psatData.responseSheet.length=0,this.dialog.showDialog({content:"OMR does not exists in this class and set combination."});this.calculateService.setOMR(t),this.functionsService.getOMRCoordinates(t.omrId),this.setResponseSheetOptions(t),this.isOMRDetailsFetched=!0}getClassSetOMR(t){this.coreService.getRequest(o.a.API_URL+"special-exams/"+t+"/class-set-stream-omr").subscribe(t=>{this.loading2=!1,this.classes=t,this.psatData.classes=[...t]})}setSet(){this.setId="",this.sets=[],this.psatData.responseSheet.length=0;let t=this.classes.find(t=>t.classId==this.classId);t&&(this.sets=t.sets)}questionType(t){return this.questionTypes[t]&&this.questionTypes[t].type}showOMRImage(){this.showOMR=!0}readImage(t){this.isOMRRead=!1;let e=t[0];this.isFileChoosed=!0;var i=new FileReader;i.readAsDataURL(e),i.onload=()=>{this.omrImageData=this.sanitizer.bypassSecurityTrustResourceUrl(i.result.toString()),this.image.src=i.result.toString(),this.image.onload=()=>{A.drawImage(this.image,0,0,1700,2200),this.isOMRRead=!0,this.functionsService.setCorners()}},i.onerror=function(t){console.log("Error: ",t)}}setSetInForm(t=null){t&&(this.psatData.set=null),this.psatData.streams=[];let e=this.psatData.classes.find(t=>t.className==this.psatData.class);e&&(this.psatData.sets=e.sets)}setStreamInForm(){this.psatData.stream=null;let t=this.psatData.sets.find(t=>t.setName==this.psatData.set);t&&(this.psatData.streams=t.streams)}scanSheet(){this.calculateService.integerQuestionsIndex=this.integerQuestionsIndex,this.psatData.name=this.calculateService.getCalculatedName(),this.psatData.mobile=this.calculateService.getCalculatedMobile(),this.psatData.rollNo=this.calculateService.getCalculatedRollNo(),this.psatData.class=this.calculateService.getCalculatedClass()+"th",this.psatData.set=this.calculateService.getCalculatedSet();let t=this.calculateService.getCalculatedResponse();this.setSetInForm(),this.setStreamInForm(),this.psatData.responseSheet.length=0,t.forEach((t,e)=>{let i={option_a:null,option_b:null,option_c:null,option_d:null};i.option_a=t.option.includes("A"),i.option_b=t.option.includes("B"),i.option_c=t.option.includes("C"),i.option_d=t.option.includes("D"),this.psatData.responseSheet[e]={single:t.option[0],multiple:i}}),this.isScanClicked=!0}setResponseSheetOptions(t){this.psatData.responseSheet.length=0;for(let e=1;e<=t.totalQuestions;e++)this.psatData.responseSheet.push({single:null,multiple:{option_a:null,option_b:null,option_c:null,option_d:null}});this.loading1=!1}resetOption(t){t.single=null,t.multiple.option_a=null,t.multiple.option_b=null,t.multiple.option_c=null,t.multiple.option_d=null}submit(){let t=[];this.psatData.responseSheet.forEach((e,i)=>{t.push({option:[]}),"S"==this.questionTypes[i].type||"I"==this.questionTypes[i].type?e.single&&t[i].option.push(e.single):(e.multiple.option_a&&t[i].option.push("A"),e.multiple.option_b&&t[i].option.push("B"),e.multiple.option_c&&t[i].option.push("C"),e.multiple.option_d&&t[i].option.push("D"))});let e={name:this.psatData.name,rollNo:this.psatData.rollNo,mobile:this.psatData.mobile,responseSheet:t,questionTypes:this.questionTypes,examId:this.examId},i=this.classes.find(t=>t.className==this.psatData.class);e.classId=i?i.classId:null;let s=this.sets.find(t=>t.setName==this.psatData.set);e.setId=s?s.setId:null;let c=this.psatData.streams.find(t=>t.stream==this.psatData.stream);e.streamId=c?c.streamId:null,this.loading1=!0,this.coreService.postRequest(o.a.API_URL+"special-exams/add-data",e).subscribe(t=>{this.loading1=!1,t.success&&this.form.resetForm(),this.dialog.showDialog({content:t.message})})}}return t.\u0275fac=function(e){return new(e||t)(a.dc(r.a),a.dc(l.a),a.dc(h.b),a.dc(u),a.dc(d))},t.\u0275cmp=a.Xb({type:t,selectors:[["add-special-exam-data"]],viewQuery:function(t,e){var i;1&t&&a.cd(I,!0),2&t&&a.Hc(i=a.sc())&&(e.form=i.first)},inputs:{examId:"examId"},decls:59,vars:22,consts:[[1,"content-title"],["type","file","name","image",3,"change"],["im",""],[3,"ngModel","ngModelChange","selectionChange"],[3,"value","innerText",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"content-box"],[3,"ngSubmit"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["matInput","","name","name","required","",3,"ngModel","ngModelChange"],["matInput","","name","rollNo","required","",3,"ngModel","ngModelChange"],["matInput","","name","mobile","required","",3,"ngModel","ngModelChange"],["name","class","required","",3,"ngModel","ngModelChange","selectionChange"],["name","set","required","",3,"ngModel","ngModelChange","selectionChange"],["class","col-sm-4",4,"ngIf"],[1,"row","response-sheet"],["class","response-item",3,"ngClass",4,"ngFor","ngForOf"],["id","submit","mat-raised-button","","color","primary",3,"disabled"],["id","canvas","width","1700","height","2200",2,"display","none"],["myCanvas",""],["id","omr-sheet","cdkDrag",""],[1,"close",3,"click"],["id","omr-image",3,"src"],[3,"show"],[3,"value","innerText"],["mat-raised-button","",3,"click",4,"ngIf"],["mat-raised-button","",3,"click"],["name","stream",3,"ngModel","required","ngModelChange"],[3,"innerText","value",4,"ngFor","ngForOf"],[3,"innerText","value"],[1,"response-item",3,"ngClass"],[3,"innerText","click",4,"ngIf"],[3,"name","ngModel","ngModelChange",4,"ngIf"],[3,"innerText","click"],[3,"name","ngModel","ngModelChange"],[3,"value"]],template:function(t,e){if(1&t){const t=a.kc();a.jc(0,"div",0),a.Wc(1),a.jc(2,"input",1,2),a.rc("change",(function(){a.Mc(t);const i=a.Ic(3);return e.readImage(i.files)})),a.ic(),a.jc(4,"mat-form-field"),a.jc(5,"mat-label"),a.Wc(6,"Select Class"),a.ic(),a.jc(7,"mat-select",3),a.rc("ngModelChange",(function(t){return e.classId=t}))("selectionChange",(function(){return e.setSet()})),a.Vc(8,B,1,2,"mat-option",4),a.ic(),a.ic(),a.jc(9,"mat-form-field"),a.jc(10,"mat-label"),a.Wc(11,"Select Set"),a.ic(),a.jc(12,"mat-select",3),a.rc("ngModelChange",(function(t){return e.setId=t}))("selectionChange",(function(){return e.setOMR()})),a.Vc(13,k,1,2,"mat-option",4),a.ic(),a.ic(),a.Vc(14,N,3,2,"ng-container",5),a.ic(),a.jc(15,"div",6),a.jc(16,"form",7,8),a.rc("ngSubmit",(function(){return e.submit()})),a.jc(18,"div",9),a.jc(19,"div",10),a.jc(20,"mat-form-field"),a.jc(21,"mat-label"),a.Wc(22,"Name"),a.ic(),a.jc(23,"input",11),a.rc("ngModelChange",(function(t){return e.psatData.name=t})),a.ic(),a.ic(),a.ic(),a.jc(24,"div",10),a.jc(25,"mat-form-field"),a.jc(26,"mat-label"),a.Wc(27,"Roll No."),a.ic(),a.jc(28,"input",12),a.rc("ngModelChange",(function(t){return e.psatData.rollNo=t})),a.ic(),a.ic(),a.ic(),a.jc(29,"div",10),a.jc(30,"mat-form-field"),a.jc(31,"mat-label"),a.Wc(32,"Mobile"),a.ic(),a.jc(33,"input",13),a.rc("ngModelChange",(function(t){return e.psatData.mobile=t})),a.ic(),a.ic(),a.ic(),a.jc(34,"div",10),a.jc(35,"mat-form-field"),a.jc(36,"mat-label"),a.Wc(37,"Class"),a.ic(),a.jc(38,"mat-select",14),a.rc("ngModelChange",(function(t){return e.psatData.class=t}))("selectionChange",(function(){return e.setSetInForm(!0)})),a.Vc(39,O,1,2,"mat-option",4),a.ic(),a.ic(),a.ic(),a.jc(40,"div",10),a.jc(41,"mat-form-field"),a.jc(42,"mat-label"),a.Wc(43,"Set"),a.ic(),a.jc(44,"mat-select",15),a.rc("ngModelChange",(function(t){return e.psatData.set=t}))("selectionChange",(function(){return e.setStreamInForm()})),a.Vc(45,w,1,2,"mat-option",4),a.ic(),a.ic(),a.ic(),a.Vc(46,_,6,3,"div",16),a.ic(),a.jc(47,"div",17),a.Vc(48,q,5,8,"div",18),a.ic(),a.jc(49,"button",19),a.Wc(50,"Submit"),a.ic(),a.ic(),a.ic(),a.jc(51,"canvas",20,21),a.Wc(53," Your browser does not support the HTML5 canvas tag."),a.ic(),a.jc(54,"div",22),a.jc(55,"div",23),a.rc("click",(function(){return e.showOMR=!1})),a.Wc(56,"\xd7"),a.ic(),a.ec(57,"img",24),a.ic(),a.ec(58,"loading",25)}if(2&t){const t=a.Ic(17);a.Pb(1),a.Yc("Add ",e.examName," Data "),a.Pb(6),a.Bc("ngModel",e.classId),a.Pb(1),a.Bc("ngForOf",e.classes),a.Pb(4),a.Bc("ngModel",e.setId),a.Pb(1),a.Bc("ngForOf",e.sets),a.Pb(1),a.Bc("ngIf",e.isOMRRead),a.Pb(9),a.Bc("ngModel",e.psatData.name),a.Pb(5),a.Bc("ngModel",e.psatData.rollNo),a.Pb(5),a.Bc("ngModel",e.psatData.mobile),a.Pb(5),a.Bc("ngModel",e.psatData.class),a.Pb(1),a.Bc("ngForOf",e.psatData.classes),a.Pb(5),a.Bc("ngModel",e.psatData.set),a.Pb(1),a.Bc("ngForOf",e.psatData.sets),a.Pb(1),a.Bc("ngIf",e.psatData.streams.length>0),a.Pb(2),a.Bc("ngForOf",e.psatData.responseSheet),a.Pb(1),a.Bc("disabled",t.invalid),a.Pb(5),a.Tc(a.Dc(20,F,e.showOMR?"block":"none")),a.Pb(3),a.Bc("src",e.omrImageData,a.Pc),a.Pb(1),a.Bc("show",e.loading1||e.loading2)}},directives:[p.b,p.e,m.a,g.k,g.n,s.j,s.k,g.v,g.l,g.m,f.a,g.b,g.r,b.b,C.a,M.a,j.h,s.i,x.b,x.a,v.a],styles:["[class*=col-][_ngcontent-%COMP%]{padding:0 5px}.content-title[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:200px;margin-left:10px}.content-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.row.response-sheet[_ngcontent-%COMP%]{flex-direction:column;max-height:420px}.response-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:150px;margin-bottom:5px}.response-item.integer[_ngcontent-%COMP%]{justify-content:flex-start}.response-item.response-item.integer[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:10px}.response-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{max-width:50px;border:2px solid;border-radius:0;outline:none;padding:5px;height:25px}.response-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:20px;text-align:center}#submit[_ngcontent-%COMP%]{margin-top:15px}#omr-sheet[_ngcontent-%COMP%]{position:absolute;max-width:500px;top:10px;left:20px;border:2px solid;z-index:4}#omr-image[_ngcontent-%COMP%]{max-width:100%;display:block}#omr-sheet[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{right:5px;top:5px}mat-checkbox[_ngcontent-%COMP%]{margin-right:-1px;margin-bottom:2px}"]}),t})();var $=i("mrSG");function U(t,e){if(1&t){const t=a.kc();a.jc(0,"div",4),a.jc(1,"div",13),a.jc(2,"mat-form-field"),a.jc(3,"mat-label"),a.Wc(4,"Name"),a.ic(),a.jc(5,"input",14),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().data.name=e})),a.ic(),a.ic(),a.ic(),a.jc(6,"div",13),a.jc(7,"mat-form-field"),a.jc(8,"mat-label"),a.Wc(9,"Roll No"),a.ic(),a.jc(10,"input",15),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().data.rollNo=e})),a.ic(),a.ic(),a.ic(),a.jc(11,"div",13),a.jc(12,"mat-form-field"),a.jc(13,"mat-label"),a.Wc(14,"Mobile"),a.ic(),a.jc(15,"input",16),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().data.mobile=e})),a.ic(),a.ic(),a.ic(),a.ic()}if(2&t){const t=a.vc();a.Pb(5),a.Bc("ngModel",t.data.name),a.Pb(5),a.Bc("ngModel",t.data.rollNo),a.Pb(5),a.Bc("ngModel",t.data.mobile)}}function L(t,e){if(1&t){const t=a.kc();a.jc(0,"mat-radio-group",21),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.single=e})),a.ec(1,"mat-radio-button",22),a.ec(2,"mat-radio-button",22),a.ec(3,"mat-radio-button",22),a.ec(4,"mat-radio-button",22),a.ic()}if(2&t){const t=a.vc(),e=t.$implicit;a.Bc("name","ans_"+t.index)("ngModel",e.single),a.Pb(1),a.Bc("value","A"),a.Pb(1),a.Bc("value","B"),a.Pb(1),a.Bc("value","C"),a.Pb(1),a.Bc("value","D")}}function J(t,e){if(1&t){const t=a.kc();a.hc(0),a.jc(1,"mat-checkbox",23),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_a=e})),a.ic(),a.jc(2,"mat-checkbox",23),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_b=e})),a.ic(),a.jc(3,"mat-checkbox",23),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_c=e})),a.ic(),a.jc(4,"mat-checkbox",23),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().$implicit.multiple.option_d=e})),a.ic(),a.gc()}if(2&t){const t=a.vc(),e=t.index,i=t.$implicit;a.Pb(1),a.Bc("name","mul-a"+e)("ngModel",i.multiple.option_a),a.Pb(1),a.Bc("name","mul-b"+e)("ngModel",i.multiple.option_b),a.Pb(1),a.Bc("name","mul-c"+e)("ngModel",i.multiple.option_c),a.Pb(1),a.Bc("name","mul-d"+e)("ngModel",i.multiple.option_d)}}function Q(t,e){if(1&t&&(a.jc(0,"div",17),a.jc(1,"span",18),a.rc("click",(function(){return e.$implicit.single=null})),a.ic(),a.Vc(2,L,5,6,"mat-radio-group",19),a.Vc(3,J,5,8,"ng-container",20),a.ic()),2&t){const t=e.index,i=a.vc();a.Pb(1),a.Bc("innerText",t+1),a.Pb(1),a.Bc("ngIf",i.showSingle(t)),a.Pb(1),a.Bc("ngIf",!i.showSingle(t))}}function K(t,e){if(1&t){const t=a.kc();a.jc(0,"button",24),a.rc("click",(function(){return a.Mc(t),a.vc().update()})),a.Wc(1,"Update"),a.ic()}}let G=(()=>{class t{constructor(t,e){this.coreService=t,this.dialog=e,this.filter={rollNo:null},this.responseSheet=[],this.data={name:null,rollNo:null,mobile:null,classId:null,setId:null,id:null},this.questionTypes=[]}ngOnInit(){this.getExamDetails()}getExamDetails(){this.coreService.getRequest(o.a.API_URL+"special-exams/"+this.examId+"/details").subscribe(t=>{this.examName=t.examName})}getAnswerKey(t){return Object($.a)(this,void 0,void 0,(function*(){return new Promise(e=>{this.coreService.getRequest(o.a.API_URL+"special-exams/set/"+t+"/answer-key").subscribe(t=>{let i=JSON.parse(t.answerKey);this.questionTypes.length=0,i.forEach(t=>{this.questionTypes.push({type:t.questionType})}),e(null)})})}))}getOMRDetails(t){return Object($.a)(this,void 0,void 0,(function*(){return new Promise(e=>{this.coreService.getRequest(o.a.API_URL+"omr/omr-details/"+t).subscribe(t=>{e(this.questionTypes=JSON.parse(t.questionsTypes))})})}))}searchData(){this.loading=!0,this.responseSheet=[];const t=o.a.API_URL+"special-exams/get-result-for-edit?rollNo="+encodeURIComponent(this.filter.rollNo)+"&examId="+this.examId;this.coreService.getRequest(t).subscribe(t=>Object($.a)(this,void 0,void 0,(function*(){if(this.loading=!1,this.isDataAvailable=t.success,t.success)return this.data=t.data,yield this.getAnswerKey(t.data.setId),this.parseData(JSON.parse(t.data.responseSheet));this.dialog.showDialog({content:"No records found with given rollNo."})})))}showSingle(t){return this.questionTypes.length>0&&"S"==this.questionTypes[t].type}parseData(t){let e=[];t.forEach((t,i)=>{if(this.showSingle(i))e.push({single:t.option[0]});else{let i={option_a:null,option_b:null,option_c:null,option_d:null};i.option_a=t.option.includes("A"),i.option_b=t.option.includes("B"),i.option_c=t.option.includes("C"),i.option_d=t.option.includes("D"),e.push({multiple:i})}this.responseSheet=e})}getFinalData(){let t=[];return this.responseSheet.forEach((e,i)=>{if(t.push({subject:e.subject,option:[]}),"S"==this.questionTypes[i].type||"I"==this.questionTypes[i].type)e.single&&t[i].option.push(e.single);else{if(!e.multiple)return;e.multiple.option_a&&t[i].option.push("A"),e.multiple.option_b&&t[i].option.push("B"),e.multiple.option_c&&t[i].option.push("C"),e.multiple.option_d&&t[i].option.push("D")}}),t}update(){this.loading=!0;const t=o.a.API_URL+"special-exams/response-sheet",e={rollNo:this.data.rollNo,name:this.data.name,id:this.data.id,classId:this.data.classId,setId:this.data.setId,mobile:this.data.mobile,responseSheet:this.getFinalData()};this.coreService.putRequest(t,e).subscribe(t=>{this.loading=!1,this.dialog.showDialog({content:t.message})})}}return t.\u0275fac=function(e){return new(e||t)(a.dc(r.a),a.dc(l.a))},t.\u0275cmp=a.Xb({type:t,selectors:[["edit-data"]],inputs:{examId:"examId"},decls:20,vars:6,consts:[[1,"content-title"],[1,"content-box"],[3,"ngSubmit"],["form","ngForm"],[1,"row"],[1,"col-sm-4"],["matInput","","name","rollNo",3,"ngModel","ngModelChange"],["id","submit","mat-raised-button","","color","primary"],["class","row",4,"ngIf"],[1,"row","response-sheet"],["class","response-item",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"show"],[1,"col-sm-3"],["name","name","matInput","",3,"ngModel","ngModelChange"],["name","rollNo","matInput","",3,"ngModel","ngModelChange"],["name","mobile","matInput","",3,"ngModel","ngModelChange"],[1,"response-item"],[3,"innerText","click"],["required","",3,"name","ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],["required","",3,"name","ngModel","ngModelChange"],[3,"value"],[3,"name","ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(a.jc(0,"div",0),a.Wc(1),a.ic(),a.jc(2,"div",1),a.jc(3,"form",2,3),a.rc("ngSubmit",(function(){return e.searchData()})),a.jc(5,"div",4),a.jc(6,"div",5),a.jc(7,"mat-form-field"),a.jc(8,"mat-label"),a.Wc(9,"Roll No."),a.ic(),a.jc(10,"input",6),a.rc("ngModelChange",(function(t){return e.filter.rollNo=t})),a.ic(),a.ic(),a.ic(),a.jc(11,"div",5),a.jc(12,"button",7),a.Wc(13,"Search"),a.ic(),a.ic(),a.ic(),a.Vc(14,U,16,3,"div",8),a.ec(15,"br"),a.ic(),a.jc(16,"div",9),a.Vc(17,Q,4,3,"div",10),a.ic(),a.Vc(18,K,2,0,"button",11),a.ic(),a.ec(19,"loading",12)),2&t&&(a.Pb(1),a.Yc("Edit ",e.examName," Data"),a.Pb(9),a.Bc("ngModel",e.filter.rollNo),a.Pb(4),a.Bc("ngIf",e.isDataAvailable),a.Pb(3),a.Bc("ngForOf",e.responseSheet),a.Pb(1),a.Bc("ngIf",e.responseSheet.length),a.Pb(1),a.Bc("show",e.loading))},directives:[g.v,g.l,g.m,p.b,p.e,f.a,g.b,g.k,g.n,b.b,s.k,s.j,M.a,x.b,g.r,x.a,v.a],styles:["[class*=col-][_ngcontent-%COMP%]{padding:0 5px}.row.response-sheet[_ngcontent-%COMP%]{flex-direction:column;max-height:420px}.response-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:140px;margin-bottom:5px}.response-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:20px;text-align:center}mat-checkbox[_ngcontent-%COMP%]{margin-right:-1px;margin-bottom:2px}"]}),t})();var z=i("icpI");function Z(t,e){if(1&t&&(a.jc(0,"div",11),a.jc(1,"div",12),a.ec(2,"img",13),a.ic(),a.jc(3,"div",10),a.jc(4,"p"),a.jc(5,"span"),a.Wc(6,"Name:"),a.ic(),a.ec(7,"span",14),a.ic(),a.jc(8,"p"),a.jc(9,"span"),a.Wc(10,"Rank:"),a.ic(),a.ec(11,"span",14),a.ic(),a.jc(12,"p"),a.jc(13,"span"),a.Wc(14,"Marks:"),a.ic(),a.ec(15,"span",14),a.ic(),a.ic(),a.jc(16,"div",10),a.jc(17,"p"),a.jc(18,"span"),a.Wc(19,"Class:"),a.ic(),a.ec(20,"span",14),a.ic(),a.jc(21,"p"),a.jc(22,"span"),a.Wc(23,"Roll No.:"),a.ic(),a.ec(24,"span",14),a.ic(),a.ic(),a.ic()),2&t){const t=a.vc();a.Pb(7),a.Bc("innerText",t.result.name),a.Pb(4),a.Bc("innerText",t.result.rank),a.Pb(4),a.Bc("innerText",t.result.marks),a.Pb(5),a.Bc("innerText",t.result.class),a.Pb(4),a.Bc("innerText",t.result.rollNo)}}const H=function(){return["Unattempted",10]},tt=function(){return["Correct",20]},et=function(){return["Wrong",4]},it=function(t,e,i){return[t,e,i]};let st=(()=>{class t{constructor(t,e){this.routes=t,this.coreService=e,this.showChart=!1,this.chartOptions={pieHole:0,legend:{position:"left"},colors:["#28a745","#1a73cc","#f44336"],sliceVisibilityThreshold:0},this.matMarks=0,this.routes.params.subscribe(t=>{this.getPSATById(t.id)})}ngOnInit(){}getPSATById(t){this.coreService.getRequest(o.a.API_URL+"psat/result/"+t).subscribe(t=>{this.result=t,this.calculateMarks()})}calculateMarks(){let t=JSON.parse(this.result.result).filter(t=>"MAT"==t.subject),e=4*t.filter(t=>"C"==t.status).length,i=t.filter(t=>"W"==t.status).length;this.matMarks=e-i}}return t.\u0275fac=function(e){return new(e||t)(a.dc(c.a),a.dc(r.a))},t.\u0275cmp=a.Xb({type:t,selectors:[["psat-analysis-report"]],inputs:{result:"result"},decls:78,vars:41,consts:[[1,"print-container"],["class","row top-row align-items-center",4,"ngIf"],[1,"row","second-row","align-items-center"],[1,"col-sm-6"],[1,"text-center"],[1,"box"],[1,"row"],[1,"chart-wrapper"],[1,"chart",3,"type","data","options"],[2,"padding-left","10px"],[1,"col-sm-4"],[1,"row","top-row","align-items-center"],[1,"col-sm-4","text-center"],["src","assets/images/logo.jpg","id","logo-img"],[3,"innerText"]],template:function(t,e){1&t&&(a.jc(0,"div",0),a.Vc(1,Z,25,5,"div",1),a.jc(2,"div",2),a.jc(3,"div",3),a.jc(4,"h2",4),a.Wc(5,"SCORE AND COMPARISON"),a.ic(),a.jc(6,"table"),a.jc(7,"tr"),a.jc(8,"th"),a.Wc(9,"Subject"),a.ic(),a.jc(10,"th"),a.Wc(11,"Your Score"),a.ic(),a.jc(12,"th"),a.Wc(13,"80%ile"),a.ic(),a.jc(14,"th"),a.Wc(15,"50%ile"),a.ic(),a.ic(),a.jc(16,"tr"),a.jc(17,"td"),a.Wc(18,"MAT"),a.ic(),a.jc(19,"td"),a.Wc(20,"80"),a.ic(),a.jc(21,"td"),a.Wc(22,"19"),a.ic(),a.jc(23,"td"),a.Wc(24,"26"),a.ic(),a.ic(),a.jc(25,"tr"),a.jc(26,"td"),a.Wc(27,"Maths"),a.ic(),a.jc(28,"td"),a.Wc(29,"80"),a.ic(),a.jc(30,"td"),a.Wc(31,"19"),a.ic(),a.jc(32,"td"),a.Wc(33,"26"),a.ic(),a.ic(),a.jc(34,"tr"),a.jc(35,"td"),a.Wc(36,"Science"),a.ic(),a.jc(37,"td"),a.Wc(38,"80"),a.ic(),a.jc(39,"td"),a.Wc(40,"19"),a.ic(),a.jc(41,"td"),a.Wc(42,"26"),a.ic(),a.ic(),a.ic(),a.ic(),a.jc(43,"div",3),a.jc(44,"div",5),a.jc(45,"h2"),a.Wc(46,"Overall"),a.ic(),a.jc(47,"div",6),a.jc(48,"div",7),a.ec(49,"google-chart",8),a.ic(),a.jc(50,"div",9),a.jc(51,"b"),a.Wc(52,"Accuracy:48%"),a.ic(),a.ic(),a.ic(),a.ic(),a.ic(),a.ic(),a.jc(53,"div",6),a.jc(54,"div",10),a.jc(55,"div",5),a.jc(56,"h2"),a.Wc(57,"MAT"),a.ic(),a.jc(58,"div",7),a.ec(59,"google-chart",8),a.ic(),a.jc(60,"b"),a.Wc(61,"Accuracy:48%"),a.ic(),a.ic(),a.ic(),a.jc(62,"div",10),a.jc(63,"div",5),a.jc(64,"h2"),a.Wc(65,"Maths"),a.ic(),a.jc(66,"div",7),a.ec(67,"google-chart",8),a.ic(),a.jc(68,"b"),a.Wc(69,"Accuracy:48%"),a.ic(),a.ic(),a.ic(),a.jc(70,"div",10),a.jc(71,"div",5),a.jc(72,"h2"),a.Wc(73,"Science"),a.ic(),a.jc(74,"div",7),a.ec(75,"google-chart",8),a.ic(),a.jc(76,"b"),a.Wc(77,"Accuracy:48%"),a.ic(),a.ic(),a.ic(),a.ic(),a.ic()),2&t&&(a.Pb(1),a.Bc("ngIf",e.result),a.Pb(48),a.Bc("type","PieChart")("data",a.Fc(16,it,a.Cc(13,H),a.Cc(14,tt),a.Cc(15,et)))("options",e.chartOptions),a.Pb(10),a.Bc("type","PieChart")("data",a.Fc(23,it,a.Cc(20,H),a.Cc(21,tt),a.Cc(22,et)))("options",e.chartOptions),a.Pb(8),a.Bc("type","PieChart")("data",a.Fc(30,it,a.Cc(27,H),a.Cc(28,tt),a.Cc(29,et)))("options",e.chartOptions),a.Pb(8),a.Bc("type","PieChart")("data",a.Fc(37,it,a.Cc(34,H),a.Cc(35,tt),a.Cc(36,et)))("options",e.chartOptions))},directives:[s.k,z.a],styles:["[class*=col-][_ngcontent-%COMP%]{padding:10px 15px}.print-container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background:#fff;left:0}#logo-img[_ngcontent-%COMP%]{max-width:225px}.top-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:4px}.top-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.top-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-style:italic;text-decoration:underline;font-weight:500}table[_ngcontent-%COMP%]{table-layout:fixed;width:100%;border-collapse:collapse}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{border:2px solid;padding:2px 10px}.box[_ngcontent-%COMP%]{border:1px solid #00a;border-radius:20px;padding:5px 10px}.box[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{text-align:center;font-size:18px;margin-top:0;margin-bottom:0}.chart-wrapper[_ngcontent-%COMP%]{overflow:hidden;height:130px}.chart[_ngcontent-%COMP%]{width:450px;height:175px;position:relative;top:-20px;left:-55px}"]}),t})();var ct=i("ZMsq");function nt(t,e){if(1&t&&a.ec(0,"mat-option",24),2&t){const t=e.$implicit;a.Bc("value",t.classId)("innerText",t.className)}}function ot(t,e){if(1&t&&a.ec(0,"mat-option",24),2&t){const t=e.$implicit;a.Bc("value",t.setId)("innerText",t.setName)}}function at(t,e){if(1&t&&a.ec(0,"mat-option",24),2&t){const t=e.$implicit;a.Bc("value",t.streamId)("innerText",t.stream)}}function rt(t,e){if(1&t){const t=a.kc();a.jc(0,"div",5),a.jc(1,"mat-form-field"),a.jc(2,"mat-label"),a.Wc(3,"Stream"),a.ic(),a.jc(4,"mat-select",25),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().streamId=e})),a.Vc(5,at,1,2,"mat-option",7),a.ic(),a.ic(),a.ic()}if(2&t){const t=a.vc();a.Pb(4),a.Bc("ngModel",t.streamId),a.Pb(1),a.Bc("ngForOf",t.streams)}}function lt(t,e){if(1&t){const t=a.kc();a.jc(0,"tr"),a.jc(1,"td"),a.jc(2,"span",27),a.rc("click",(function(){a.Mc(t);const i=e.$implicit;return a.vc(2).showDetailedReport(i)})),a.ic(),a.ic(),a.ec(3,"td",28),a.ec(4,"td",28),a.ec(5,"td",28),a.ec(6,"td",28),a.ec(7,"td",28),a.ec(8,"td",28),a.ec(9,"td",28),a.ic()}if(2&t){const t=e.$implicit;a.Pb(2),a.Bc("innerText",t.name),a.Pb(1),a.Bc("innerText",t.mobile),a.Pb(1),a.Bc("innerText",t.rollNo),a.Pb(1),a.Bc("innerText",t.marks),a.Pb(1),a.Bc("innerText",t.correct),a.Pb(1),a.Bc("innerText",t.wrong),a.Pb(1),a.Bc("innerText",t.skipped),a.Pb(1),a.Bc("innerText",t.rank)}}function ht(t,e){if(1&t&&(a.jc(0,"table",26),a.jc(1,"tr"),a.jc(2,"th"),a.Wc(3,"Name"),a.ic(),a.jc(4,"th"),a.Wc(5,"Mobile"),a.ic(),a.jc(6,"th"),a.Wc(7,"Roll No."),a.ic(),a.jc(8,"th"),a.Wc(9,"Marks"),a.ic(),a.jc(10,"th"),a.Wc(11,"Correct"),a.ic(),a.jc(12,"th"),a.Wc(13,"Wrong"),a.ic(),a.jc(14,"th"),a.Wc(15,"Skipped"),a.ic(),a.jc(16,"th"),a.Wc(17,"Rank"),a.ic(),a.ic(),a.Vc(18,lt,10,8,"tr",22),a.ic()),2&t){const t=a.vc();a.Pb(18),a.Bc("ngForOf",t.results)}}function dt(t,e){if(1&t&&(a.jc(0,"tr"),a.ec(1,"td",28),a.ec(2,"td",28),a.ec(3,"td",28),a.ec(4,"td",28),a.ec(5,"td",28),a.ic()),2&t){const t=e.$implicit,i=e.index;a.Pb(1),a.Bc("innerText",i+1),a.Pb(1),a.Bc("innerText",t.subject),a.Pb(1),a.Bc("innerText",t.bonus?"Bonus":t.status),a.Pb(1),a.Bc("innerText",t.choosed),a.Pb(1),a.Bc("innerText",t.correct)}}const ut=function(){return{width:"600px"}};let pt=(()=>{class t{constructor(t,e,i,s){this.coreService=t,this.dialog=e,this.router=i,this.routes=s,this.loading1=!0,this.loading2=!0,this.classes=[],this.classId="",this.sets=[],this.setId="",this.streams=[],this.streamId="",this.name="",this.mobile="",this.results=[],this.detailedReport=[]}ngOnInit(){this.getClassSetStream(this.examId),this.getExamDetails()}getExamDetails(){this.coreService.getRequest(o.a.API_URL+"special-exams/"+this.examId+"/details").subscribe(t=>{this.examName=t.examName,this.loading1=!1})}getClassSetStream(t){this.coreService.getRequest(o.a.API_URL+"special-exams/"+t+"/class-set-stream-omr").subscribe(t=>{this.classes=t,this.loading2=!1})}setSets(){this.setId="",this.streamId="",this.streams=[];let t=this.classes.find(t=>t.classId==this.classId);t&&(this.sets=t.sets)}setStreams(){this.streamId="",this.streams=[];let t=this.sets.find(t=>t.setId==this.setId);t&&(this.streams=t.streams)}showDetailedReport(t){this.loading1=!0,this.coreService.getRequest(o.a.API_URL+"special-exams/results/"+t.id).subscribe(e=>{this.loading1=!1,this.showReport=!0,this.activeReport={mobile:t.mobile},this.detailedReport=e})}showAnalysisReport(t){this.router.navigate([]).then(e=>{window.open("/test/psat-result/"+t.mobile,"_blank")})}search(){this.loading1=!0;let t=o.a.API_URL+"special-exams/results";const e={classId:this.classId,setId:this.setId,streamId:this.streamId,name:this.name,mobile:this.mobile,examId:this.examId};let i=[];for(let[s,c]of Object.entries(e))i.push(encodeURIComponent(s)+"="+encodeURIComponent(c));t+="?"+i.join("&"),this.coreService.getRequest(t).subscribe(t=>{this.results=t.result,this.setRank(this.results,t.myClassMarks),this.loading1=!1})}setRank(t,e){t.forEach(t=>{let i=e.find(e=>e.id==t.id);t.rank=e.indexOf(i)+1})}}return t.\u0275fac=function(e){return new(e||t)(a.dc(r.a),a.dc(l.a),a.dc(c.b),a.dc(c.a))},t.\u0275cmp=a.Xb({type:t,selectors:[["special-exams-result"]],inputs:{examId:"examId"},decls:57,vars:15,consts:[[1,"content-title"],[1,"content-box"],[3,"ngSubmit"],["searchForm","ngForm"],[1,"row","align-items-center"],[1,"col-sm-3"],["name","class",3,"ngModel","ngModelChange","selectionChange"],[3,"value","innerText",4,"ngFor","ngForOf"],["name","set",3,"ngModel","ngModelChange","selectionChange"],["class","col-sm-3",4,"ngIf"],["name","name","matInput","",3,"ngModel","ngModelChange"],["name","mobile","matInput","",3,"ngModel","ngModelChange"],["mat-raised-button","","color","primary",3,"disabled"],["class","pinnacle-table big-heading ptqe-table",4,"ngIf"],["modal","",1,"modal",3,"show","options"],[1,"dialog"],[1,"modal-header"],[1,"close",3,"click"],[1,"modal-body"],[1,"text-center"],["mat-raised-button","","color","primary",3,"click"],[1,"pinnacle-table"],[4,"ngFor","ngForOf"],[3,"show"],[3,"value","innerText"],["name","stream",3,"ngModel","ngModelChange"],[1,"pinnacle-table","big-heading","ptqe-table"],[2,"cursor","pointer",3,"innerText","click"],[3,"innerText"]],template:function(t,e){1&t&&(a.jc(0,"div",0),a.Wc(1),a.ic(),a.jc(2,"div",1),a.jc(3,"form",2,3),a.rc("ngSubmit",(function(){return e.search()})),a.jc(5,"div",4),a.jc(6,"div",5),a.jc(7,"mat-form-field"),a.jc(8,"mat-label"),a.Wc(9,"Class"),a.ic(),a.jc(10,"mat-select",6),a.rc("ngModelChange",(function(t){return e.classId=t}))("selectionChange",(function(){return e.setSets()})),a.Vc(11,nt,1,2,"mat-option",7),a.ic(),a.ic(),a.ic(),a.jc(12,"div",5),a.jc(13,"mat-form-field"),a.jc(14,"mat-label"),a.Wc(15,"Set"),a.ic(),a.jc(16,"mat-select",8),a.rc("ngModelChange",(function(t){return e.setId=t}))("selectionChange",(function(){return e.setStreams()})),a.Vc(17,ot,1,2,"mat-option",7),a.ic(),a.ic(),a.ic(),a.Vc(18,rt,6,2,"div",9),a.jc(19,"div",5),a.jc(20,"mat-form-field"),a.jc(21,"mat-label"),a.Wc(22,"Name"),a.ic(),a.jc(23,"input",10),a.rc("ngModelChange",(function(t){return e.name=t})),a.ic(),a.ic(),a.ic(),a.jc(24,"div",5),a.jc(25,"mat-form-field"),a.jc(26,"mat-label"),a.Wc(27,"Mobile"),a.ic(),a.jc(28,"input",11),a.rc("ngModelChange",(function(t){return e.mobile=t})),a.ic(),a.ic(),a.ic(),a.jc(29,"div",5),a.jc(30,"button",12),a.Wc(31,"Search"),a.ic(),a.ic(),a.ic(),a.ic(),a.ic(),a.Vc(32,ht,19,1,"table",13),a.jc(33,"div",14),a.jc(34,"div",15),a.jc(35,"div",16),a.Wc(36,"Detailed Report"),a.ic(),a.jc(37,"div",17),a.rc("click",(function(){return e.showReport=!1})),a.Wc(38,"\xd7"),a.ic(),a.jc(39,"div",18),a.jc(40,"div",19),a.jc(41,"button",20),a.rc("click",(function(){return e.showAnalysisReport(e.activeReport)})),a.Wc(42,"Analysis Report"),a.ic(),a.ic(),a.jc(43,"table",21),a.jc(44,"tr"),a.jc(45,"th"),a.Wc(46,"SNo."),a.ic(),a.jc(47,"th"),a.Wc(48,"Subject"),a.ic(),a.jc(49,"th"),a.Wc(50,"Status"),a.ic(),a.jc(51,"th"),a.Wc(52,"Your Answer"),a.ic(),a.jc(53,"th"),a.Wc(54,"Correct Answer"),a.ic(),a.ic(),a.Vc(55,dt,6,5,"tr",22),a.ic(),a.ic(),a.ic(),a.ic(),a.ec(56,"loading",23)),2&t&&(a.Pb(1),a.Yc("",e.examName," Result"),a.Pb(9),a.Bc("ngModel",e.classId),a.Pb(1),a.Bc("ngForOf",e.classes),a.Pb(5),a.Bc("ngModel",e.setId),a.Pb(1),a.Bc("ngForOf",e.sets),a.Pb(1),a.Bc("ngIf",e.streams.length>0),a.Pb(5),a.Bc("ngModel",e.name),a.Pb(5),a.Bc("ngModel",e.mobile),a.Pb(2),a.Bc("disabled",!e.classId),a.Pb(2),a.Bc("ngIf",e.results.length>0),a.Pb(1),a.Bc("show",e.showReport)("options",a.Cc(14,ut)),a.Pb(22),a.Bc("ngForOf",e.detailedReport),a.Pb(1),a.Bc("show",e.loading1||e.loading2))},directives:[g.v,g.l,g.m,p.b,p.e,m.a,g.k,g.n,s.j,s.k,f.a,g.b,b.b,ct.a,M.a,j.h],styles:["[class*=col-][_ngcontent-%COMP%]{padding:0 5px}.ptqe-table[_ngcontent-%COMP%]{margin-top:20px}"]}),t})();function mt(t,e){if(1&t&&a.ec(0,"mat-option",13),2&t){const t=e.$implicit;a.Bc("value",t.classId)("innerText",t.className)}}function gt(t,e){if(1&t&&a.ec(0,"mat-option",13),2&t){const t=e.$implicit;a.Bc("value",t.setId)("innerText",t.setName)}}function ft(t,e){if(1&t&&a.ec(0,"mat-option",13),2&t){const t=e.$implicit;a.Bc("value",t.streamId)("innerText",t.stream)}}function bt(t,e){if(1&t){const t=a.kc();a.jc(0,"div",5),a.jc(1,"mat-form-field"),a.jc(2,"mat-label"),a.Wc(3,"Stream"),a.ic(),a.jc(4,"mat-select",14),a.rc("ngModelChange",(function(e){return a.Mc(t),a.vc().streamId=e})),a.Vc(5,ft,1,2,"mat-option",7),a.ic(),a.ic(),a.ic()}if(2&t){const t=a.vc();a.Pb(4),a.Bc("ngModel",t.streamId)("required",t.streams.length>0),a.Pb(1),a.Bc("ngForOf",t.streams)}}let Ct=(()=>{class t{constructor(t,e){this.coreService=t,this.dialog=e,this.loading1=!0,this.loading2=!0,this.classes=[],this.classId="",this.sets=[],this.setId="",this.streams=[],this.streamId=""}ngOnInit(){this.getClassSetOMR(this.examId),this.getExamDetails()}getExamDetails(){this.coreService.getRequest(o.a.API_URL+"special-exams/"+this.examId+"/details").subscribe(t=>{this.examName=t.examName,this.loading1=!1})}getClassSetOMR(t){this.coreService.getRequest(o.a.API_URL+"special-exams/"+t+"/class-set-stream-omr").subscribe(t=>{this.classes=t,this.loading2=!1})}setSet(){this.setId="",this.sets=[],this.streamId="",this.streams=[];let t=this.classes.find(t=>t.classId==this.classId);t&&(this.sets=t.sets)}setStreams(){this.streamId="",this.streams=[];let t=this.sets.find(t=>t.setId==this.setId);t&&(this.streams=t.streams)}regenerate(){this.loading1=!0,this.coreService.putRequest(o.a.API_URL+"special-exams/regenerate-result",{classId:this.classId,setId:this.setId,streamId:this.streamId}).subscribe(t=>{this.loading1=!1,this.dialog.showDialog({content:t.message})})}}return t.\u0275fac=function(e){return new(e||t)(a.dc(r.a),a.dc(l.a))},t.\u0275cmp=a.Xb({type:t,selectors:[["regenerate-result"]],inputs:{examId:"examId"},decls:23,vars:8,consts:[[1,"content-title"],[1,"content-box"],[3,"ngSubmit"],["reForm","ngForm"],[1,"row","align-items-center"],[1,"col-sm-4"],["name","class","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value","innerText",4,"ngFor","ngForOf"],["name","set","required","",3,"ngModel","ngModelChange","selectionChange"],["class","col-sm-4",4,"ngIf"],[1,"col-sm-3"],["mat-raised-button","","color","primary",3,"disabled"],[3,"show"],[3,"value","innerText"],["name","stream",3,"ngModel","required","ngModelChange"]],template:function(t,e){if(1&t&&(a.jc(0,"div",0),a.Wc(1),a.ic(),a.jc(2,"div",1),a.jc(3,"form",2,3),a.rc("ngSubmit",(function(){return e.regenerate()})),a.jc(5,"div",4),a.jc(6,"div",5),a.jc(7,"mat-form-field"),a.jc(8,"mat-label"),a.Wc(9,"Class"),a.ic(),a.jc(10,"mat-select",6),a.rc("ngModelChange",(function(t){return e.classId=t}))("selectionChange",(function(){return e.setSet()})),a.Vc(11,mt,1,2,"mat-option",7),a.ic(),a.ic(),a.ic(),a.jc(12,"div",5),a.jc(13,"mat-form-field"),a.jc(14,"mat-label"),a.Wc(15,"Set"),a.ic(),a.jc(16,"mat-select",8),a.rc("ngModelChange",(function(t){return e.setId=t}))("selectionChange",(function(){return e.setStreams()})),a.Vc(17,gt,1,2,"mat-option",7),a.ic(),a.ic(),a.ic(),a.Vc(18,bt,6,3,"div",9),a.jc(19,"div",10),a.jc(20,"button",11),a.Wc(21,"Regenerate"),a.ic(),a.ic(),a.ic(),a.ic(),a.ic(),a.ec(22,"loading",12)),2&t){const t=a.Ic(4);a.Pb(1),a.Yc("Regenerate ",e.examName," Result"),a.Pb(9),a.Bc("ngModel",e.classId),a.Pb(1),a.Bc("ngForOf",e.classes),a.Pb(5),a.Bc("ngModel",e.setId),a.Pb(1),a.Bc("ngForOf",e.sets),a.Pb(1),a.Bc("ngIf",e.streams.length>0),a.Pb(2),a.Bc("disabled",t.invalid),a.Pb(2),a.Bc("show",e.loading1||e.loading2)}},directives:[g.v,g.l,g.m,p.b,p.e,m.a,g.r,g.k,g.n,s.j,s.k,b.b,M.a,j.h],styles:["[class*=col-][_ngcontent-%COMP%]{padding:0 5px}"]}),t})();var Mt=i("aCk2"),jt=i("G0I0");function xt(t,e){if(1&t&&a.ec(0,"add-special-exam-data",4),2&t){const t=a.vc();a.Bc("examId",t.examId)}}function vt(t,e){if(1&t&&a.ec(0,"edit-data",4),2&t){const t=a.vc();a.Bc("examId",t.examId)}}function It(t,e){if(1&t&&a.ec(0,"special-exams-result",4),2&t){const t=a.vc();a.Bc("examId",t.examId)}}function Bt(t,e){if(1&t&&a.ec(0,"regenerate-result",4),2&t){const t=a.vc();a.Bc("examId",t.examId)}}const kt=[{path:"",component:(()=>{class t{constructor(){}ngOnInit(){if(sessionStorage.getItem("selectedComponent")){let t=JSON.parse(sessionStorage.getItem("selectedComponent"));this.activeComponent=t.link,this.examId=t.examId}}showSelectedComponent(t){this.activeComponent="",sessionStorage.setItem("selectedComponent",JSON.stringify(t)),setTimeout(()=>{this.activeComponent=t.link}),this.examId=t.examId}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Xb({type:t,selectors:[["app-special-exams-home"]],decls:8,vars:5,consts:[[3,"onSpecialExams"],["id","page-content"],[3,"ngSwitch"],[3,"examId",4,"ngSwitchCase"],[3,"examId"]],template:function(t,e){1&t&&(a.jc(0,"admin-header",0),a.rc("onSpecialExams",(function(t){return e.showSelectedComponent(t)})),a.ic(),a.ec(1,"admin-sidebar"),a.jc(2,"div",1),a.hc(3,2),a.Vc(4,xt,1,1,"add-special-exam-data",3),a.Vc(5,vt,1,1,"edit-data",3),a.Vc(6,It,1,1,"special-exams-result",3),a.Vc(7,Bt,1,1,"regenerate-result",3),a.gc(),a.ic()),2&t&&(a.Pb(3),a.Bc("ngSwitch",e.activeComponent),a.Pb(1),a.Bc("ngSwitchCase","add"),a.Pb(1),a.Bc("ngSwitchCase","edit"),a.Pb(1),a.Bc("ngSwitchCase","result"),a.Pb(1),a.Bc("ngSwitchCase","regenerate"))},directives:[Mt.a,jt.a,s.m,s.n,V,G,pt,Ct],styles:[""]}),t})()},{path:":examId",component:V},{path:":examId/edit",component:G},{path:":examId/result",component:pt},{path:":examId/regenerate-result",component:Ct},{path:"psat-analysis-report/:id",component:st}];let Pt=(()=>{class t{}return t.\u0275mod=a.bc({type:t}),t.\u0275inj=a.ac({factory:function(e){return new(e||t)},imports:[[s.c,n.a,c.f.forChild(kt)]]}),t})()}}]);